---
---
---

# üåç CASA0005 GIS - Assignment Week 4

**Author:** Haotian Lu\
**Date:** 26 October 2025

------------------------------------------------------------------------

### To begin with, load all the necessary packages

```{r}
library(sf)
library(dplyr)
library(readr)
library(tmap)
```

### Loading data1: the worldwide shpfile

```{r}
worldshp <- st_read('/Volumes/ExFAT 400G/Documents/TERM1/05_GIS/DATA/WEEK4/World_Countries_(Generalized)_-573431906301700955/World_Countries_Generalized.shp')

```

### Transform the coordinates and extract the useful columns.

```{r}
worldshp84 <- st_transform(worldshp, 4326)
st_crs(worldshp84)
names(worldshp84)
world_clean <- worldshp84 %>%
  select(iso = ISO, country = COUNTRY, geometry)
head(world_clean)
```

### Loading data2: the 2010 & 2019 csv

```{r}
data2010 <- read_csv('/Volumes/ExFAT 400G/Documents/TERM1/05_GIS/DATA/WEEK4/2010.csv',
                       locale = locale(encoding = "latin1"),
                       na = "n/a")
data2019 <- read_csv('/Volumes/ExFAT 400G/Documents/TERM1/05_GIS/DATA/WEEK4/2019.csv',
                     locale = locale(encoding = "latin1"),
                     na = "n/a")
```

### Extract the required columns from the CSV and calculate the differences.

```{r}
gii2010 <- data2010 %>%
  select(iso = countryIsoCode, country, GII_2010 = value)
gii2019 <- data2019 %>%
  select(iso = countryIsoCode, country, GII_2019 = value)
differencedata <- gii2010 %>%
  merge(
    .,
    gii2019,
    by.x="iso",
    by.y="iso"
  ) %>%
  mutate(diff_2010_2019 = GII_2019 - GII_2010)
```

### Link the difference outcomes with shpfile

```{r}
mapdata <- world_clean %>%
  merge(
    .,
    differencedata,
    by.x="country",
    by.y="country.x"
  )
```

### Make some adjustment, and get a static map

```{r}
tmap_mode("plot")

tm_shape(mapdata) +
  tm_polygons(
    col = "diff_2010_2019",
    palette = "-RdYlBu",              
    border.col = "grey60",             
    lwd = 0.3,                         
    title = "Difference",
    showNA = FALSE
  ) +
  tm_layout(
    title = "Global Gender Inequality Index Change (2010‚Äì2019)",
    title.size = 1.2,
    title.position = c("center", "top"),
    frame = FALSE,
    legend.position = c("left", "bottom"), 
    legend.bg.color = "white",             
    legend.bg.alpha = 0.8,                 
    legend.text.size = 0.8,
    legend.title.size = 0.9,
    inner.margins = c(0.05, 0.05, 0.1, 0.1), 
    asp = 0                               
  ) +
  tm_compass(
    type = "8star",
    size = 2,
    position = c("left", "top")
  ) +
  tm_scale_bar(
    position = c("right", "bottom")
  )
```

### An interactive map by OSM

Deeper colour, worse situation.

```{r}
tmap_mode("view")

tm_shape(mapdata) + 
  tm_polygons(
    fill = "diff_2010_2019",
    palette = "Reds",
    style = "jenks",
    alpha = 0.7,
    id = "country",
    popup.vars = c(
      "Country:" = "country",
      "Data_2010:" = "GII_2010",
      "Data_2019:" = "GII_2019",
      "Diff:" = "diff_2010_2019"
    ),
    title = "Diff (2010 ‚àí> 2019)"
  ) +
  tm_basemap(server = "OpenStreetMap") +
  tm_compass(type = "arrow", position = c("left", "bottom")) + 
  tm_scalebar(position = c("left", "bottom")) +
  tm_title("Change in Gender Inequality Index (2010 -> 2019)",
           size = 2,
           position = c("center", "top"))
```

## Data source:

##### Global gender inequality data: <https://hdr.undp.org/data-center/documentation-and-downloads>

##### Spatial data of the World: <https://hub.arcgis.com/datasets/2b93b06dc0dc4e809d3c8db5cb96ba69_0/explore?location=-0.052517%2C0.000000%2C1.41>
